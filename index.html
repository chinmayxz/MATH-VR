<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VR Math Trivia</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<style>
body { margin: 0; overflow: hidden; font-family: 'Arial', sans-serif; }
#ui { position: absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:10; }
#startScreen,#categoryScreen,#gameScreen,#resultsScreen {
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    background: rgba(0,20,40,0.95); padding:40px; border-radius:20px; text-align:center;
    pointer-events:all; box-shadow:0 10px 50px rgba(0,255,255,0.3); border:2px solid rgba(0,255,255,0.5);
    max-width:600px; z-index:11;
}
h1 { color:#00ffff; margin:0 0 20px 0; font-size:2.5em; text-shadow:0 0 10px #00ffff; }
h2 { color:#00ddff; margin:0 0 20px 0; font-size:1.8em; }
button { background: linear-gradient(135deg, #0066cc, #00ccff); color:white; border:none; padding:15px 30px; margin:10px; font-size:1.1em; border-radius:10px; cursor:pointer; transition:all 0.3s; box-shadow:0 4px 15px rgba(0,200,255,0.4); }
button:hover { transform:translateY(-2px); box-shadow:0 6px 20px rgba(0,200,255,0.6); }
button:active { transform:translateY(0); }
.category-btn { display:block; width:100%; margin:15px 0; }
.answer-btn { display:block; width:100%; text-align:left; padding:15px 20px; margin:10px 0; background:linear-gradient(135deg,#1a5080,#2a7090); }
.answer-btn.correct { background: linear-gradient(135deg,#00aa00,#00ff00); }
.answer-btn.incorrect { background: linear-gradient(135deg,#aa0000,#ff0000); }
#score { color:#ffff00; font-size:1.3em; margin:10px 0; text-shadow:0 0 5px #ffff00; }
#progress { color:#aaddff; font-size:1.1em; margin:10px 0; }
.hidden { display:none; }
p { color:#aaddff; font-size:1.1em; margin:15px 0; }
#vrButton { position:absolute; top:20px; right:20px; pointer-events:all; background:linear-gradient(135deg,#8a2be2,#9370db); z-index:100; }
#vrButton:hover { background: linear-gradient(135deg,#9b30ff,#a07aff); }
#vrButton.vr-active { background: linear-gradient(135deg,#ff4500,#ff6347); }
#controls { position:absolute; bottom:20px; left:20px; color:white; background:rgba(0,0,0,0.5); padding:10px; border-radius:5px; pointer-events:none; z-index:100; }
</style>
</head>
<body>
<div id="ui">
    <div id="startScreen">
        <h1>üåä VR Math Trivia üåä</h1>
        <p>Test your math knowledge in a stunning waterfall environment!</p>
        <button onclick="showCategories()">Start Game</button>
    </div>

    <div id="categoryScreen" class="hidden">
        <h2>Choose Your Category</h2>
        <button class="category-btn" onclick="startGame('geometry')">üìê Geometry</button>
        <button class="category-btn" onclick="startGame('algebra')">üî¢ Algebra</button>
        <button class="category-btn" onclick="startGame('calculus')">üìä Calculus</button>
    </div>

    <div id="gameScreen" class="hidden">
        <div id="score">Score: 0</div>
        <div id="progress">Question 1/10</div>
        <div id="question"></div>
        <div id="answers"></div>
    </div>

    <div id="resultsScreen" class="hidden">
        <h1>Round Complete! üéâ</h1>
        <div id="finalScore"></div>
        <button onclick="showCategories()">Play Again</button>
        <button onclick="location.reload()">Main Menu</button>
    </div>
    
    <button id="vrButton" onclick="toggleVR()">Enter VR Mode</button>
</div>

<div id="controls">
    <p>Point controller at buttons and pull trigger</p>
    <p>Drag to look around (Desktop)</p>
</div>

<script>
let scene, camera, renderer, vrUIGroup, controllers = [];
let score = 0, currentQuestion = 0, attempted = false, currentCategory = '';
let isVRMode = false;
let vrButtons = [];
let currentVRScreen = 'start';
let hoveredButton = null;

const questions = {
    geometry: [
        {q:"Sum of angles in triangle?", a:["180¬∞","360¬∞","90¬∞","270¬∞"], c:0},
        {q:"Sides in hexagon?", a:["5","6","7","8"], c:1},
        {q:"Circle area, radius 5?", a:["78.5","31.4","15.7","157"], c:0},
        {q:"Square perimeter, side 4?", a:["8","12","16","20"], c:2},
        {q:"Faces on a cube?", a:["4","6","8","12"], c:1},
        {q:"Cube volume, side 3?", a:["9","27","18","12"], c:1},
        {q:"Degrees in right angle?", a:["45¬∞","90¬∞","180¬∞","360¬∞"], c:1},
        {q:"Circle circumference, r=2?", a:["6.28","12.56","3.14","9.42"], c:1},
        {q:"Edges on a cube?", a:["6","8","12","16"], c:2},
        {q:"Rectangle area: 5√ó3?", a:["8","15","18","20"], c:1}
    ],
    algebra: [
        {q:"Solve: 2x + 5 = 15", a:["5","10","7.5","20"], c:0},
        {q:"x¬≤ when x = 4?", a:["8","16","12","20"], c:1},
        {q:"Simplify: 3x + 2x", a:["5x","6x","5x¬≤","x‚Åµ"], c:0},
        {q:"Calculate: 3√ó(4+2)", a:["14","18","20","12"], c:1},
        {q:"Solve: x - 7 = 3", a:["10","4","-4","7"], c:0},
        {q:"What is 2¬≥?", a:["6","8","9","16"], c:1},
        {q:"Simplify: 4x - x", a:["3x","4x","5x","3"], c:0},
        {q:"What is ‚àö16?", a:["2","4","8","16"], c:1},
        {q:"Solve: 3x = 21", a:["6","7","8","18"], c:1},
        {q:"What is 5¬≤?", a:["10","15","25","50"], c:2}
    ],
    calculus: [
        {q:"Derivative of x¬≤?", a:["x","2x","x¬≤","2"], c:1},
        {q:"Integral ‚à´x dx?", a:["x","x¬≤","x¬≤/2+C","2x"], c:2},
        {q:"Derivative of constant?", a:["1","0","x","?"], c:1},
        {q:"Derivative of 3x?", a:["3","3x","x","0"], c:0},
        {q:"Integral ‚à´3 dx?", a:["3","3x","3x+C","x"], c:2},
        {q:"Derivative of x¬≥?", a:["3x","3x¬≤","x¬≤","3"], c:1},
        {q:"d/dx(sin x)?", a:["cos x","-cos x","sin x","-sin x"], c:0},
        {q:"Integral ‚à´2x dx?", a:["2x","x¬≤","x¬≤+C","2"], c:2},
        {q:"Derivative of 5x¬≤?", a:["5x","10x","5","10"], c:1},
        {q:"Power rule d/dx(x^n)?", a:["nx^n","nx^(n-1)","x^n","n"], c:1}
    ]
};

function initScene(){
    scene = new THREE.Scene();
    scene.background = new THREE.Color(0x87ceeb);
    scene.fog = new THREE.Fog(0x87ceeb,50,200);

    camera = new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
    camera.position.set(0,1.6,3);
    camera.lookAt(0,1.6,0);

    renderer = new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(window.innerWidth,window.innerHeight);
    renderer.xr.enabled = true;
    document.body.appendChild(renderer.domElement);

    const ambientLight = new THREE.AmbientLight(0xffffff,0.6);
    scene.add(ambientLight);
    const directionalLight = new THREE.DirectionalLight(0xffffff,0.8);
    directionalLight.position.set(50,50,50);
    scene.add(directionalLight);

    create360Environment();
    createEnvironmentObjects();
    createVRUI();
    setupVRControllers();
    setupVRButton();
    animate();
}

function create360Environment(){
    const geometry = new THREE.SphereGeometry(500,60,40);
    geometry.scale(-1,1,1);
    const canvas = document.createElement('canvas');
    canvas.width=2048; canvas.height=1024;
    const ctx = canvas.getContext('2d');
    const gradient = ctx.createLinearGradient(0,0,0,canvas.height);
    gradient.addColorStop(0,'#1a2980'); gradient.addColorStop(1,'#26d0ce');
    ctx.fillStyle = gradient; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle = 'rgba(255,255,255,0.7)';
    for(let i=0;i<15;i++){ 
        ctx.beginPath(); 
        ctx.arc(Math.random()*canvas.width,Math.random()*canvas.height/2,50+Math.random()*80,0,Math.PI*2); 
        ctx.fill(); 
    }
    const texture = new THREE.CanvasTexture(canvas);
    texture.minFilter = THREE.LinearFilter;
    texture.magFilter = THREE.LinearFilter;
    const material = new THREE.MeshBasicMaterial({map:texture});
    scene.add(new THREE.Mesh(geometry,material));
}

function createEnvironmentObjects(){
    const pool = new THREE.Mesh(
        new THREE.CylinderGeometry(25,25,1,32), 
        new THREE.MeshPhongMaterial({color:0x1e90ff,transparent:true,opacity:0.7,shininess:100})
    );
    pool.position.y=-1; 
    scene.add(pool);

    for(let i=0;i<3;i++){
        const cliff = new THREE.Mesh(
            new THREE.BoxGeometry(15,40,15), 
            new THREE.MeshPhongMaterial({color:0x808080})
        );
        cliff.position.set(Math.cos(i*Math.PI*2/3)*30,19,Math.sin(i*Math.PI*2/3)*30);
        scene.add(cliff);
    }

    const particles = new THREE.BufferGeometry();
    const pos = new Float32Array(1000*3);
    for(let i=0;i<pos.length;i+=3){ 
        pos[i]=(Math.random()-0.5)*60; 
        pos[i+1]=Math.random()*50+10; 
        pos[i+2]=(Math.random()-0.5)*60; 
    }
    particles.setAttribute('position',new THREE.BufferAttribute(pos,3));
    const particleMat = new THREE.PointsMaterial({color:0xffffff,size:0.3,transparent:true,opacity:0.8});
    scene.add(new THREE.Points(particles,particleMat));

    for(let i=0;i<15;i++){
        const trunk = new THREE.Mesh(
            new THREE.CylinderGeometry(0.5,0.7,8,8),
            new THREE.MeshPhongMaterial({color:0x8b4513})
        );
        const leaves = new THREE.Mesh(
            new THREE.SphereGeometry(3,8,8),
            new THREE.MeshPhongMaterial({color:0x228b22})
        );
        leaves.position.y=6; 
        trunk.add(leaves);
        const angle=(i/15)*Math.PI*2, radius=35+Math.random()*10;
        trunk.position.set(Math.cos(angle)*radius,3,Math.sin(angle)*radius);
        scene.add(trunk);
    }
}

function setupVRControllers(){
    for(let i=0; i<=1; i++){
        const controller = renderer.xr.getController(i);
        controller.addEventListener('selectstart', onSelectStart);
        controller.addEventListener('selectend', onSelectEnd);
        scene.add(controller);
        controllers.push(controller);
        
        // Controller ray
        const geometry = new THREE.BufferGeometry().setFromPoints([
            new THREE.Vector3(0,0,0),
            new THREE.Vector3(0,0,-5)
        ]);
        const line = new THREE.Line(geometry, new THREE.LineBasicMaterial({color:0x00ffff}));
        controller.add(line);
    }
}

function onSelectStart(event){
    const controller = event.target;
    checkControllerIntersection(controller, true);
}

function onSelectEnd(event){
    // Click completed
}

function checkControllerIntersection(controller, clicked = false){
    if(vrButtons.length === 0) return;
    
    const tempMatrix = new THREE.Matrix4();
    tempMatrix.identity().extractRotation(controller.matrixWorld);
    
    const raycaster = new THREE.Raycaster();
    raycaster.ray.origin.setFromMatrixPosition(controller.matrixWorld);
    raycaster.ray.direction.set(0, 0, -1).applyMatrix4(tempMatrix);
    
    const intersects = raycaster.intersectObjects(vrButtons);
    
    if(intersects.length > 0){
        const button = intersects[0].object;
        if(clicked && button.userData.action){
            button.userData.action();
            
            // Visual feedback
            const originalScale = button.scale.clone();
            button.scale.multiplyScalar(0.95);
            setTimeout(() => {
                button.scale.copy(originalScale);
            }, 100);
        }
        return button;
    }
    return null;
}

function createVRUI(){
    vrUIGroup = new THREE.Group();
    vrUIGroup.position.set(0, 1.6, -2.5);
    scene.add(vrUIGroup);
    
    updateVRUI();
}

function createTextCanvas(text, width, height, bgColor, textColor, fontSize = 80){
    const canvas = document.createElement('canvas');
    canvas.width = width;
    canvas.height = height;
    const ctx = canvas.getContext('2d');
    
    // Anti-aliasing
    ctx.imageSmoothingEnabled = true;
    ctx.imageSmoothingQuality = 'high';
    
    // Background with rounded corners
    ctx.fillStyle = bgColor;
    const radius = 20;
    ctx.beginPath();
    ctx.moveTo(radius, 0);
    ctx.lineTo(width - radius, 0);
    ctx.quadraticCurveTo(width, 0, width, radius);
    ctx.lineTo(width, height - radius);
    ctx.quadraticCurveTo(width, height, width - radius, height);
    ctx.lineTo(radius, height);
    ctx.quadraticCurveTo(0, height, 0, height - radius);
    ctx.lineTo(0, radius);
    ctx.quadraticCurveTo(0, 0, radius, 0);
    ctx.closePath();
    ctx.fill();
    
    // Add subtle border
    ctx.strokeStyle = 'rgba(0,200,255,0.5)';
    ctx.lineWidth = 4;
    ctx.stroke();
    
    // Text with shadow
    ctx.shadowColor = 'rgba(0,0,0,0.5)';
    ctx.shadowBlur = 10;
    ctx.shadowOffsetX = 2;
    ctx.shadowOffsetY = 2;
    
    ctx.fillStyle = textColor;
    ctx.font = `bold ${fontSize}px Arial, sans-serif`;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    
    // Word wrap
    const words = text.split(' ');
    const lines = [];
    let currentLine = '';
    
    words.forEach(word => {
        const testLine = currentLine + word + ' ';
        const metrics = ctx.measureText(testLine);
        if (metrics.width > width - 80 && currentLine !== '') {
            lines.push(currentLine.trim());
            currentLine = word + ' ';
        } else {
            currentLine = testLine;
        }
    });
    lines.push(currentLine.trim());
    
    const lineHeight = fontSize * 1.3;
    const startY = (height - (lines.length * lineHeight)) / 2 + fontSize / 2;
    
    lines.forEach((line, i) => {
        ctx.fillText(line, width / 2, startY + i * lineHeight);
    });
    
    return canvas;
}

function createVRButton(text, x, y, action, color = '#0066cc', isAnswer = false){
    const width = isAnswer ? 2048 : 1536;
    const height = isAnswer ? 384 : 320;
    const canvas = createTextCanvas(text, width, height, color, '#ffffff', isAnswer ? 70 : 80);
    const texture = new THREE.CanvasTexture(canvas);
    texture.minFilter = THREE.LinearFilter;
    texture.magFilter = THREE.LinearFilter;
    texture.anisotropy = renderer.capabilities.getMaxAnisotropy();
    
    const buttonWidth = isAnswer ? 2.2 : 1.8;
    const buttonHeight = isAnswer ? 0.42 : 0.38;
    
    const geometry = new THREE.PlaneGeometry(buttonWidth, buttonHeight);
    const material = new THREE.MeshBasicMaterial({
        map: texture, 
        transparent: true,
        side: THREE.DoubleSide
    });
    const button = new THREE.Mesh(geometry, material);
    button.position.set(x, y, 0);
    button.userData = {
        action: action, 
        defaultColor: color, 
        text: text,
        isAnswer: isAnswer
    };
    vrUIGroup.add(button);
    vrButtons.push(button);
    return button;
}

function createVRPanel(text, x, y, width, height, bgColor = '#001428', fontSize = 70){
    const canvas = createTextCanvas(text, 2048, 768, bgColor, '#aaddff', fontSize);
    const texture = new THREE.CanvasTexture(canvas);
    texture.minFilter = THREE.LinearFilter;
    texture.magFilter = THREE.LinearFilter;
    texture.anisotropy = renderer.capabilities.getMaxAnisotropy();
    
    const geometry = new THREE.PlaneGeometry(width, height);
    const material = new THREE.MeshBasicMaterial({
        map: texture, 
        transparent: true, 
        opacity: 0.95,
        side: THREE.DoubleSide
    });
    const panel = new THREE.Mesh(geometry, material);
    panel.position.set(x, y, 0.01);
    vrUIGroup.add(panel);
    return panel;
}

function clearVRUI(){
    while(vrUIGroup.children.length > 0){
        vrUIGroup.remove(vrUIGroup.children[0]);
    }
    vrButtons = [];
}

function updateVRUI(){
    clearVRUI();
    
    if(currentVRScreen === 'start'){
        createVRPanel('VR MATH TRIVIA', 0, 0.9, 3, 0.5, '#001428', 90);
        createVRPanel('Test your math knowledge!', 0, 0.4, 3, 0.35, '#001a40', 60);
        createVRButton('START GAME', 0, -0.2, () => { currentVRScreen = 'category'; updateVRUI(); });
    }
    else if(currentVRScreen === 'category'){
        createVRPanel('CHOOSE CATEGORY', 0, 0.9, 3, 0.5, '#001428', 85);
        createVRButton('GEOMETRY', 0, 0.2, () => startVRGame('geometry'));
        createVRButton('ALGEBRA', 0, -0.3, () => startVRGame('algebra'));
        createVRButton('CALCULUS', 0, -0.8, () => startVRGame('calculus'));
    }
    else if(currentVRScreen === 'game'){
        const q = questions[currentCategory][currentQuestion % questions[currentCategory].length];
        createVRPanel(`Score: ${score}  |  Q ${currentQuestion + 1}/10`, 0, 1.1, 3.5, 0.35, '#001428', 65);
        createVRPanel(q.q, 0, 0.7, 3.5, 0.5, '#001a40', 65);
        
        q.a.forEach((answer, i) => {
            const y = 0.15 - i * 0.5;
            createVRButton(answer, 0, y, () => checkVRAnswer(i, q.c), '#1a5080', true);
        });
    }
    else if(currentVRScreen === 'results'){
        createVRPanel('ROUND COMPLETE!', 0, 0.9, 3, 0.5, '#001428', 85);
        createVRPanel(`Final Score: ${score}/100`, 0, 0.4, 3, 0.45, '#001a40', 75);
        createVRButton('PLAY AGAIN', 0, -0.2, () => { currentVRScreen = 'category'; updateVRUI(); });
        createVRButton('MAIN MENU', 0, -0.7, () => { currentVRScreen = 'start'; updateVRUI(); });
    }
}

function startVRGame(category){
    currentCategory = category;
    score = 0;
    currentQuestion = 0;
    attempted = false;
    currentVRScreen = 'game';
    updateVRUI();
}

function checkVRAnswer(selectedIndex, correctIndex){
    if(selectedIndex === correctIndex){
        if(!attempted){
            score += 10;
        }
        setTimeout(() => {
            currentQuestion++;
            attempted = false;
            if(currentQuestion >= 10){
                currentVRScreen = 'results';
            }
            updateVRUI();
        }, 600);
    } else {
        attempted = true;
    }
}

function setupVRButton(){
    const vrButton = document.getElementById('vrButton');
    
    if('xr' in navigator){
        navigator.xr.isSessionSupported('immersive-vr').then((supported) => {
            if(!supported){
                vrButton.textContent = 'VR Not Supported';
                vrButton.disabled = true;
            }
        });
    } else {
        vrButton.textContent = 'VR Not Available';
        vrButton.disabled = true;
    }
}

function toggleVR(){
    const vrButton = document.getElementById('vrButton');
    
    if(!isVRMode){
        vrButton.textContent = 'Exit VR Mode';
        vrButton.classList.add('vr-active');
        
        if('xr' in navigator){
            navigator.xr.requestSession('immersive-vr', {
                optionalFeatures: ['local-floor', 'bounded-floor', 'hand-tracking']
            }).then((session) => {
                renderer.xr.setSession(session);
                isVRMode = true;
                document.getElementById('ui').style.display = 'none';
                
                session.addEventListener('end', () => {
                    isVRMode = false;
                    vrButton.textContent = 'Enter VR Mode';
                    vrButton.classList.remove('vr-active');
                    document.getElementById('ui').style.display = 'block';
                });
            }).catch((err) => {
                console.error('VR Error:', err);
                vrButton.textContent = 'Enter VR Mode';
                vrButton.classList.remove('vr-active');
                alert('Failed to enter VR mode');
            });
        }
    } else {
        const session = renderer.xr.getSession();
        if(session) session.end();
    }
}

function updateControllerHighlights(){
    if(!isVRMode || vrButtons.length === 0) return;
    
    let anyHovered = false;
    
    controllers.forEach(controller => {
        const hoveredBtn = checkControllerIntersection(controller, false);
        
        if(hoveredBtn && hoveredBtn !== hoveredButton){
            // Highlight this button
            const canvas = createTextCanvas(
                hoveredBtn.userData.text, 
                hoveredBtn.userData.isAnswer ? 2048 : 1536, 
                hoveredBtn.userData.isAnswer ? 384 : 320,
                '#00aaff', 
                '#ffffff', 
                hoveredBtn.userData.isAnswer ? 70 : 80
            );
            const texture = new THREE.CanvasTexture(canvas);
            texture.minFilter = THREE.LinearFilter;
            texture.magFilter = THREE.LinearFilter;
            texture.anisotropy = renderer.capabilities.getMaxAnisotropy();
            hoveredBtn.material.map = texture;
            hoveredBtn.material.needsUpdate = true;
            hoveredBtn.scale.set(1.05, 1.05, 1);
            hoveredButton = hoveredBtn;
            anyHovered = true;
        }
    });
    
    if(!anyHovered && hoveredButton){
        // Reset previous button
        const canvas = createTextCanvas(
            hoveredButton.userData.text, 
            hoveredButton.userData.isAnswer ? 2048 : 1536, 
            hoveredButton.userData.isAnswer ? 384 : 320,
            hoveredButton.userData.defaultColor, 
            '#ffffff', 
            hoveredButton.userData.isAnswer ? 70 : 80
        );
        const texture = new THREE.CanvasTexture(canvas);
        texture.minFilter = THREE.LinearFilter;
        texture.magFilter = THREE.LinearFilter;
        texture.anisotropy = renderer.capabilities.getMaxAnisotropy();
        hoveredButton.material.map = texture;
        hoveredButton.material.needsUpdate = true;
        hoveredButton.scale.set(1, 1, 1);
        hoveredButton = null;
    }
}

function animate(){
    renderer.setAnimationLoop(() => {
        if(isVRMode){
            updateControllerHighlights();
        } else {
            camera.position.x = Math.sin(Date.now() * 0.0002) * 2 + 0;
            camera.lookAt(0, 1.6, 0);
        }
        
        const particles = scene.children.find(c => c instanceof THREE.Points);
        if(particles){
            const positions = particles.geometry.attributes.position.array;
            for(let i=1; i<positions.length; i+=3){ 
                positions[i] -= 0.3; 
                if(positions[i] < 0) positions[i] = 60; 
            }
            particles.geometry.attributes.position.needsUpdate = true;
        }
        
        renderer.render(scene, camera);
    });
}

function showCategories(){
    document.getElementById('startScreen').classList.add('hidden'); 
    document.getElementById('resultsScreen').classList.add('hidden'); 
    document.getElementById('categoryScreen').classList.remove('hidden');
}

function startGame(cat){
    currentCategory = cat; 
    score = 0; 
    currentQuestion = 0; 
    document.getElementById('categoryScreen').classList.add('hidden'); 
    document.getElementById('gameScreen').classList.remove('hidden'); 
    loadQuestion();
}

function loadQuestion(){
    if(currentQuestion >= 10){
        showResults(); 
        return;
    }
    
    attempted = false; 
    const categoryQuestions = questions[currentCategory]; 
    const randomQ = categoryQuestions[Math.floor(Math.random() * categoryQuestions.length)];
    
    document.getElementById('question').textContent = randomQ.q;
    document.getElementById('progress').textContent = `Question ${currentQuestion+1}/10`;
    document.getElementById('score').textContent = `Score: ${score}`;
    
    const answersDiv = document.getElementById('answers'); 
    answersDiv.innerHTML = '';
    
    randomQ.a.forEach((answer, index) => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn'; 
        btn.textContent = answer;
        btn.onclick = () => {
            if(index === randomQ.c){
                btn.classList.add('correct'); 
                if(!attempted){
                    score += 10; 
                    document.getElementById('score').textContent = `Score: ${score}`;
                } 
                setTimeout(() => {
                    currentQuestion++; 
                    loadQuestion();
                }, 1000);
            } else {
                btn.classList.add('incorrect'); 
                attempted = true; 
                setTimeout(() => {
                    btn.classList.remove('incorrect');
                }, 500);
            }
        };
        answersDiv.appendChild(btn);
    });
}

function showResults(){
    document.getElementById('gameScreen').classList.add('hidden'); 
    document.getElementById('finalScore').textContent = `Final Score: ${score}/100`; 
    document.getElementById('resultsScreen
